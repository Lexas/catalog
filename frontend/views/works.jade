//- 
	Catalog web/view

	Copyright 2014 Commons Machinery http://commonsmachinery.se/

	Authors:
		Elsa Balderrama <elsa@commonsmachinery.se>

	Distributed under an AGPL_v3 license, please see LICENSE in the top dir.

- var works = data
- data = {"data":works};
- var stringData = JSON.stringify(data);

mixin workView(data)
	- var data = data || {}
	- var creator = data.creator.match(/users\/([^\/]+)/)[1]
	div.entries(class="grid-25 tablet-grid-50 mobile-grid-100")
		h2: a(href="#{data.resource}") #{data.id}
		span(name="visibility")
		span(name="state")
		a.seeMeta(href="#{data.metadata}" name="metadata") (see metadata...)
		span.info
			| by 
			a(href="#{data.creator}") #{creator} 
			| on 
			span(name="created") #{data.created} 
			if data.updated
				- var updatedBy = data.updatedBy.match(/users\/([^\/]+)/)[1]
				br
				| last updated by 
				a(href="#{data.updatedBy}") #{updatedBy} 
				| on 
				span(name="updated") #{data.updated}

include includes/top
	for work in works
		+workView(work)
include includes/bottom

script#workTemplate(type="text/template")
	+workView(works[0])

script#bootstrapData #{stringData}

