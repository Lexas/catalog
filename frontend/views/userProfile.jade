//- Catalog web - user public profile page
//- 
//- Copyright 2014 Commons Machinery http://commonsmachinery.se/
//- Distributed under an AGPL_v3 license, please see LICENSE in the top dir.

//- TODO: this page is hardcoded for now, as there's nothing
//- interestingly dynamic to do yet.

- var profile = user.profile;

mixin defTerm(term, caption)
    if term
        dt(class=caption.toLowerCase())
            dd: | #{term}    

include includes/top
    | #{JSON.stringify(userData, true, true)}
    div.userProfile
        img.gravatar(src=gravatarHashURL(profile.gravatar_hash, 237))
        dl
            defTerm(profile.name || user.alias, 'User')
            defTerm(profile.email, 'Email')
            defterm(profile.location, 'Location')
            defTerm(profile.website, 'Website')
    if userId == user.id
        div 
            a(href='#{user}/sources'): My stock sources
    if user._perms.write === true
        input(type='button' value='edit profile')

    include includes/bottom

    script.bootstrapData(type='application/json')
        != bootstrapData({ "data": profile })
