// 
    Catalog web/views

    Copyright 2014 Commons Machinery http://commonsmachinery.se/

    Authors:
        Elsa Balderrama <elsa@commonsmachinery.se>
        Peter Liljenberg <peter@commonsmachinery.se>

    Distributed under an AGPL_v3 license, please see LICENSE in the top dir.

doctype html
meta(charset="utf-8") 

// To support Persona
meta(http-equiv="X-UA-Compatible", content="IE=Edge")
meta(name="viewport", content="width=device-width initial-scale=1 minimum-scale=1 maximum-scale=1")

html(lang="en")
    head
        title Catalog
        link(rel="stylesheet", href="/css/style.css")
        script(src="https://login.persona.org/include.js")
        script(src="/lib/require.js", data-main="/app/boot")
        
    body(data-login-user=user || '', data-login-email=loginEmail || '', data-login-type=loginType || '')
        header(class="grid-container grid-100")
            div#logo(class="grid-30 tablet-grid-40 mobile-grid-100"): a(href="/")
            div(class="grid-50 tablet-grid-60 mobile-grid-100"): nav
                ul#pages
                    li: a(href="/"): img(src="/media/home.png")
                    li: a(href="/works"): | catalog
                ul#user
                    if (user)
                        li(class="#{loginType}"): a(href="/users/#{user}")
                            | #{loginEmail}
                        case loginType
                            when 'persona'
                                li: a#logout-persona(href="#")
                                    | Logout
                            when 'test'
                                li: a(href="/test/logout")
                                    | Logout
                    else
                        li: a(href="/login")
                            | Login
        nav#breadCrumbs: ul
            - var path = url;
            - path = path.replace(/(^\/|\/$)/g, '').split('/');
            for i in path
                - step = i.match(/([-_A-Z]?[^A-Z]*)/g);
                - step = step.join(' ').toLowerCase();
                if i != path[path.length -1]
                    - var exp = new RegExp('.*' + i + '(.*)', 'i');
                    - var remove = url.match(exp)[1];
                    li: a(href="#{url.replace(remove, '')}") #{step}
                else
                    li.last: | #{step}
        div#content(class="grid-container")
            | 
